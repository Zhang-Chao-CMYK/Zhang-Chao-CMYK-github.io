function tpl2html(e,t){return code="var p=[];with(this){p.push('"+e.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');",new Function(code).apply(t)}function text2html(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r\n?|\n/g,"<br>")}function loadScript(e,t,a){for(var r=document.getElementsByTagName("script"),n=0;n<r.length;n++){var o=r[n];if(""==o.innerHTML.trim()){var i=o.getAttribute("key4unique"),d=o.getAttribute("src");if("string"==typeof a&&"string"==typeof i&&i==a||"string"==typeof d&&d==e)return void t()}}var l=document.createElement("script");l.type="text/javascript",!l.attachEvent||l.attachEvent.toString&&l.attachEvent.toString().indexOf("[native code")<0?l.addEventListener("load",function(e){("load"===e.type||readyRegExp.test((e.currentTarget||e.srcElement).readyState))&&t(e)},!1):l.attachEvent("onreadystatechange",function(e){("load"===e.type||readyRegExp.test((e.currentTarget||e.srcElement).readyState))&&t(e)}),void 0!==a&&l.setAttribute("key4unique",a),l.src=e,document.getElementsByTagName("head")[0].appendChild(l)}_modaltpl='<div class="modal fade" id="automodal_<%=idindex%>" tabindex="-1" role="dialog" aria-hidden="true">    <div class="modal-dialog  modal-sm modal-dialog-centered" role="document">        <div class="modal-content gradient-green  z4">            <div class="modal-header">                <h5 class="modal-title" id="exampleModalLabel"><%=title%></h5>                <button type="button" class="close" data-dismiss="modal" aria-label="Close">                    <span aria-hidden="true">×</span>                </button>            </div>            <form method="<%=method%>" <% if(action.length>0){ %> action="<%=action%>" <% } %> >            <input type="hidden" name="op" value="<%=op%>">            <div class="modal-body"><%=body%><%=bodyext%></div>            <div class="modal-footer">                <button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>                <button type="submit" class="btn btn-primary">提交</button>            </div>            </form>        </div>    </div></div>';var ktmfautoindex=1;function modal(e){e.idindex=ktmfautoindex++,_html=tpl2html(_modaltpl,e),$(_html).modal()}function modal_promot(e,t){_dft="",_placeholder="",void 0!==t.default&&(_dft=t.default),void 0!==t.placeholder&&(_placeholder=t.placeholder),t.body='<input type="text" class="form-control" name="'+e+'" value="'+_dft+'" placeholder="'+_placeholder+'" >',modal(t=$.extend({title:"请输入",method:"post",placeholder:"",default:"",action:"",op:"",body:"",bodyext:""},t))}function modal_select(e,t,a){_html='<select class="form-control" name="'+e+'" >',$.each(t,function(e,t){void 0!==t.value?_value=t.value:void 0!==t.id?_value=t.id:_value=e,_html+='<option value="'+_value+'">'+t.name+"</option>"}),_html+="</select>",a.body=_html,modal(a=$.extend({title:"请选择",method:"post",action:"",op:"",body:"",bodyext:""},a))}function modal_form(e,t){}function weuitimepicker(e){var t=e,a=[],r=0;for(r=0;r<24;r++)a.push({label:r+"时",value:r});var n=[];for(r=0;r<60;r++)n.push({label:r+"分",value:r});var o=[];for(r=0;r<60;r++)o.push({label:r+"秒",value:r});weui.picker(a,n,o,{defaultValue:[7,40,0],onChange:function(e){console.log(e)},onConfirm:function(e){$(t).val(zeroPad(e[0])+":"+zeroPad(e[1])+":"+zeroPad(e[2])).trigger("change")},id:"timePicker",title:"选择时间"})}function weuitimepicker_nos(e,t,a,r){var n=e,o=[],i=0;for(i=0;i<24;i++)o.push({label:zeroPad(i)+"时",value:i});var d=[];for(i=0;i<60;i++)d.push({label:zeroPad(i)+"分",value:i});"string"==typeof a&&a?a=a.split(":").map(function(e){return parseInt(e)}):a||(a=[7,40]);weui.picker(o,d,{defaultValue:a,onConfirm:function(e){var a=zeroPad(e[0])+":"+zeroPad(e[1]);$(n).val(a).trigger("change"),t&&t(e,a)},id:r||"timeNosPicker",title:"选择时间"})}function weuidatepicker(e){var t=$(e),a=t.val();a=a.split("-").map(function(e){return parseInt(e)}),weui.datePicker({defaultValue:a,onConfirm:function(e){const a=e.map(function(e){return e<10?"0"+e:e}).join("-");t.val(a).trigger("change")}})}function weuidatetimepicker(e){var t=e,a="",r=$(e).attr("format")||"Y-m-d H:i:s",n="Y-m-d"!==r,o="Y-m-d H:i:s"===r,i=!1;["rd[fn_907]","rd[fn_2379]"].includes($(e).attr("name"))&&(o=!1,i=!0);var d=new Date,l=d.getHours(),c=d.getMinutes(),s=(d.getSeconds(),$(e).hasClass("vue"));weui.datePicker({onConfirm:function(e){a=e[0]+"-"+zeroPad(e[1])+"-"+zeroPad(e[2])+" "},onClose:function(){if(""!=a){if(!n)return $(t).val(a).trigger("change"),void(s&&t.dispatchEvent(new CustomEvent("input")));var e=[],r=0;for(r=0;r<24;r++)e.push({label:r+"时",value:r});var d=[];for(r=0;r<60;r++)d.push({label:r+"分",value:r});var f=[e,d];if(o){var u=[];for(r=0;r<60;r++)u.push({label:r+"秒",value:r});f.push(u)}f.push({defaultValue:[l,i?0:c,0],onChange:function(e){},onConfirm:function(e){var r=a+zeroPad(e[0])+":"+zeroPad(e[1]);o&&(r+=":"+zeroPad(e[2])),$(t).val(r).trigger("change"),s&&t.dispatchEvent(new CustomEvent("input"))},id:"timePicker",title:"选择时间（"+a+"）"}),weui.picker.apply(weui.picker,f)}},id:"datePicker",title:"选择日期"})}function zeroPad(e){return e<10?"0"+(e||0):e}function calendarDraw(e,t){date=new Date(e,t,0);var a=new Date(date.getFullYear(),date.getMonth()+1,0).getDate();new Date(date.getFullYear(),date.getMonth(),0).getDate(),new Date(date.getFullYear(),date.getMonth()+2,0).getDate();date.setDate(1);var r=date.getDay();0==r&&(r=7),date=new Date(e,t,0);var n="<table class='calendarDrawTable'><tr><th>日</th><th>一</th><th>二</th><th>三</th><th>四</th><th>五</th><th>六</th>";_index=0;for(var o=1;o<=r%7;o++)_index%7==0&&(n+="</tr><tr>"),_index++,n+="<td></td>";for(var i=1;i<=a;i++)_index%7==0&&(n+="</tr><tr>"),_index++,_dta=new Array,_dta.push(e),_dta.push(zeroPad(t)),_dta.push(zeroPad(i)),n+='<td dt="'+_dta.join("")+'">'+i+"</td>";n+="</tr></table>";var d=date.getMonth()+1,l=date.getFullYear();return 1==d?(PrevYear=l-1,PrevMonth=12):(PrevYear=l,PrevMonth=d-1),12==d?(NextYear=l+1,NextMonth=1):(NextYear=l,NextMonth=d+1),{html:n,cur:{year:e,month:t},prev:{year:PrevYear,month:PrevMonth},next:{year:NextYear,month:NextMonth}}}function bjmf_studentinfo(e,t){$.get("/teacher/data/course/"+e+"/student/"+t,function(e){_info="姓名:"+e.name+"\n",_info+="学号:"+e.no+"\n",_info+="性别:"+e.sex+"\n",_info+="班级:"+e.groupname+"\n",void 0!==e.roomname&&(_info+="宿舍:"+e.roomname+"\n"),alert(_info)},"json")}function html_upload_js(e,t,a,r){if($("#bjmfuploader_"+e).length>0&&$("#"+e).next("div.jFiler").remove(),$("#"+e).after('<input type="file" name="files[]" id="bjmfuploader_'+e+'" multiple autocomplete="off">'),"function"!=typeof kkbupfileschged){var n=void 0===window.sitecdn?"//c.d8n.cn":window.sitecdn;$('<link rel="stylesheet" type="text/css" href="'+n+'/res/upload/css/jquery.filer.css?3">').appendTo("body"),$('<script src="/res/upload/js/jquery.filer.min.js?19" type="text/javascript"><\/script>').appendTo("body"),window.kkbupfileschged=function(e,t){$("#"+t).val(JSON.stringify(e))}}var o=[],i=$("#"+e).val();if(i&&i.length>5){var d=JSON.parse($("#"+e).val());$.each(d,function(e,t){void 0!==t.file&&void 0!==t.name&&void 0!==t.type&&void 0!==t.size&&o.push(t)})}if(r&&r.capture){var l=in_weixin()&&in_mobile()?"点此拍照并上传":"无法拍照，请使用手机操作";filer_default_opts.changeInput2='<div class="jFiler-input-dragDrop"> <div class="jFiler-input-inner"> <a class="jFiler-input-choose-btn blue-light">'+l+"</a> </div>"}filer_default_opts.ossRole=t,filer_default_opts.ossPath=a||"",$("#bjmfuploader_"+e).filer($.extend({changeInput:filer_default_opts.changeInput2,showThumbs:!0,theme:"dragdropbox",templates:filer_default_opts.templates,dragDrop:filer_default_opts.dragDrop,uploadFile:filer_default_opts.uploadFile,onRemove:filer_default_opts.onRemove,onRemoved:filer_default_opts.onRemoved,beforeSelect:filer_default_opts.beforeSelect,prepareInput:filer_default_opts.prepareInput,files:o},r))}function get_current_role(){var e=location.pathname,t="student";return e.startsWith("/teacher")?t="teacher":e.startsWith("/org")&&(t="org"),t}function html_upload_js_auto(e,t,a){a=a||location.pathname,html_upload_js(e||"attachment",get_current_role(),a,t)}function upload_file_directly(e,t,a){"function"!=typeof kkbupfileschged&&$('<script src="/res/upload/js/jquery.filer.min.js?19" type="text/javascript"><\/script>').appendTo("body"),filer_default_opts.ossRole=get_current_role(),filer_default_opts.ossPath=location.pathname;var r=new FormData;filer_default_opts.prepareKey({uploadFile:"/uploadfile"},r,t,function(t){var n=location.hostname,o=n.startsWith("localhost")||n.endsWith(".local")||n.endsWith(".hans")||!t||!t.host,i=o?"files[]":"file",d=o?"/uploadfile":t.host;r.append(i,e);var l=new XMLHttpRequest;l.open("POST",d,!0),l.setRequestHeader("X-Requested-With","XMLHttpRequest"),l.onreadystatechange=function(){if(4===l.readyState&&200===l.status){var e=JSON.parse(l.responseText);e&&401===e.code&&e.msg?alert(e.msg):e&&e.success?a([e.data]):e&&e.length?a(e):alert("上传失败！")}},l.send(r)})}$(function(){$("textarea.form-control,textarea.layui-textarea").each(function(){$(this).css("height",Math.max(this.scrollHeight,66)+"px"),$(this).css("overflow-y","hidden")}).on("input",function(){$(this).css("height","auto"),$(this).height(Math.max(this.scrollHeight,33))})});var bjmf_voice={localId:"",serverId:""},bjmf_luyin_ing=!1;function bjmf_wx_luyin_2texted(e){"undefined"!=typeof bjmf_wx_luyin_2texted_cb&&bjmf_wx_luyin_2texted_cb(e.translateResult)}function bjmf_wx_luyin_started(e){bjmf_luyin_ing=!0,$("#bjmf_luyin_area").html('<button type="button" onclick="bjmf_wx_luyin_stop()">录音中...点击停止</button>'),"undefined"!=typeof bjmf_wx_luyin_started_cb&&bjmf_wx_luyin_started_cb(e)}function bjmf_wx_luyin_stoped(e){bjmf_luyin_ing=!1,bjmf_voice.localId=e.localId,bjmf_wx_luyin_2text(),$("#bjmf_luyin_area").html('<button type="button" onclick="bjmf_wx_luyin_start()">开始录音</button>'),"undefined"!=typeof bjmf_wx_luyin_stoped_cb&&bjmf_wx_luyin_stoped_cb(e)}function bjmf_wx_luyin_start(){wx.startRecord({success:function(e){bjmf_luyin_ing=!0,bjmf_wx_luyin_started(e)},cancel:function(){bjmf_luyin_ing=!1,alert("已拒绝录音")}})}function bjmf_wx_luyin_stop(){wx.stopRecord({success:function(e){bjmf_voice.localId=e.localId,bjmf_wx_luyin_stoped(e)},fail:function(e){alert(JSON.stringify(e))}})}function bjmf_wx_luyin_2text(){wx.translateVoice({localId:bjmf_voice.localId,complete:function(e){e.hasOwnProperty("translateResult")?bjmf_wx_luyin_2texted(e):alert("无法识别")}})}function bjmf_title(){var e=document.title,t=$("header.fixed-header > .center");return t?(t.text()||e).trim():e}var wx_photo_serverids=[];function wx_camera_photo(e){wx_photo_serverids=[],wx.chooseImage({count:1,sizeType:["compressed"],sourceType:["camera"],success:function(t){var a=t.localIds;for(i=0;i<a.length;i++)wx.uploadImage({localId:a[i],isShowProgressTips:1,success:function(t){wx_photo_serverids.push(t.serverId),void 0!==e&&e(this.localId,t.serverId)},fail:function(e){alert("微信图片上传失败，请重试。".JSON.stringify(e))}})}})}function getGroupLabel(e){return(e.find(".control-label").text()||"").replace(/[*：:]+$/g,"")}function checkUnfinishedField(e){for(var t=$(e).find(".form-group:visible"),a=null,r=0;r<t.length;r++){var n=t.eq(r);if(!(n.find(".required-mark").length<=0)){var o=n.data("type");if(["radio","checkbox"].indexOf(o)>=0){if(n.find("input:checked").length<=0){a=getGroupLabel(n);break}}else{var i=n.find("input, textarea, select").filter("[name]").val();if(!i||""===$.trim(i)||"file"===o&&"[]"===$.trim(i)){a=getGroupLabel(n);break}}}}return!!a&&(weui.alert("请完成必填项："+a,{title:"提示"}),!0)}function _autoLinkTextNodesReplace(e,t,a){for(var r,n,o=[],i=[],d=0;null!==(r=e.exec(t));)n=r.index,r[1]&&r[0][0]!==r[1][0]&&n++,o.push(t.slice(d,n)),o.push(r[1]||r[0]),i.push(n),d=r.index+r[0].length,r[1]&&r[0][r[0].length-1]!==r[1][r[1].length-1]&&d--;if(i.length){for(o.push(t.slice(d)),n=0;n<o.length;n++)n%2&&(o[n]=a(o[n]));return o}return[t]}function _autoLinkTextNodes(e,t){try{document.querySelectorAll("span, p, td, label, div").forEach(function(a){a.childNodes.forEach(function(a){if(a.nodeType===Node.TEXT_NODE){var r=a.textContent,n=_autoLinkTextNodesReplace(e,r,t);if(n.length>1){for(var o=[],i=0;i<n.length;i++){var d;i%2?(d=document.createElement("span")).innerHTML=n[i]:d=document.createTextNode(n[i]),o.push(d)}a.replaceWith.apply(a,o)}}})})}catch(e){console.log(e)}}function autoLinkTextNodes(){_autoLinkTextNodes(/(?:^|[^a-zA-Z0-9])(1[3-9][0-9]{9})(?:[^a-zA-Z0-9]|$)/g,function(e){return'<a href="tel:'+e+'" class="link">'+e+"</a>"}),_autoLinkTextNodes(/https?:\/\/[-A-Za-z0-9+&@#\/%?=~_|!:,.;]+[-A-Za-z0-9+&@#\/%=~_|]/g,function(e){return'<a href="'+e+'" class="link" target="_blank">'+e+"</a>"})}function addRedDots(){$("[dote]").each(function(){var e=$(this),t=e.attr("dote");t&&(localStorage.getItem(t)||e.addClass("rt-dot"),e.hasClass("rt-dot-t")&&e.on("click",function(){localStorage.setItem(t,"true")}))})}function getFavoriteLinks(){try{var e=localStorage.getItem("exam_favorite_links")||"{}";e=JSON.parse(e)||{}}catch(t){console.log(t),e={}}return e}function countFavoriteLink(e){try{var t=getFavoriteLinks(),a=t[e.href]||0;t[e.href]=a+1,localStorage.setItem("exam_favorite_links",JSON.stringify(t))}catch(e){console.log(e)}}function renderFavoriteLinks(){try{var e=[],t=getFavoriteLinks();if($.each(t,function(t,a){a>=10&&e.push({href:t,count:a})}),e.length<=0)return;e.sort(function(e,t){return t.count-e.count});var a=$(".favorite-list .row"),r={};$(".card-body.menu-list .col-3 > a").each(function(){r[this.href]=$(this).parent()});var n=0;$.each(e,function(e,t){if(n>=4)return!1;r[t.href]&&(r[t.href].clone().appendTo(a),n++)}),n&&$(".favorite-list").show()}catch(e){console.log(e)}}function timeStr(e){return e&&e.endsWith?e.split(":").length<=2?e:e.endsWith(":00")?e.substring(0,e.length-3):e:e}function table_col_toggle(e,t,a){Array.isArray(t)||(t=[t]),$.each(t,function(t,r){$(e+" tr").find("td:eq("+r+"),th:eq("+r+")").toggle(a)})}function table2xls(e,t,a){var r=null,n="sheet1";"string"==typeof t?r=t:(r=t.filename,n=t.worksheet||"Worksheet");var o=$("#"+e).prop("outerHTML");$_html=$(o),$_html.removeAttr("style"),$_html.find("td[export='no']").remove(),$_html.find("th[export='no']").remove(),html2xls(o=$_html.prop("outerHTML"),r,n,a)}function html2xls(e,t,a,r){void 0===a&&(a="sheet1"),void 0===t&&(t="data"),t+=".xls",uri="data:application/vnd.ms-excel;base64,",xlstemplate='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><meta http-equiv="content-type" content="application/vnd.ms-excel; charset=UTF-8"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style type="text/css">td{mso-number-format:"@"}</style></head><body>{table}</body></html>',base64=function(e){return window.btoa(unescape(encodeURIComponent(e)))},format=function(e,t){return e.replace(/{(\w+)}/g,function(e,a){return t[a]})};var n=format(xlstemplate,{worksheet:a,table:e}),o=base64(n);if(window.navigator.msSaveBlob){var i=b64toBlob(o);window.navigator.msSaveBlob(i,t)}else if(navigator.userAgent.indexOf("MicroMessenger")>-1||navigator.userAgent.indexOf("WindowsWechat")>-1){var d={content:n};$.post("/teacher/post2oss?ext=xls",d,function(e){e.error?alert(e.msg):document.location.href="/teacher/exp_result?file="+e.data},"json")}else{var l=$('<a style="display:none"></a>').appendTo("body");l[0].href=uri+o,l[0].download=t,l[0].click(),l.remove()}}function bjmform_snapshot(e,t){window["bjmform_snapshot_"+e]=$(t).html()}function bjmform_clear(e,t){var a="bjmform_snapshot_"+e;window[a]||bjmform_snapshot(e,t),$(t).html(window[a]),$(".form-control-datetimepicker").on("click",function(){weuidatetimepicker(this)}),bjmform_addr_auto_flag=!1}function bjmform_getdata_full(e,t){var a=bjmform_getdata(e,t);return $(e).find("[bjmfform_autogps]").each(function(){var e=$(this).attr("name");e.length<=t.length||e.substr(0,t.length)!==t||(e=e.substr(t.length+1,e.length-t.length-2),a[e]=$(this).val())}),a}function bjmform_ele_clear(e){var t=$(e).attr("type");void 0===t||"radio"!=t&&"checkbox"!=t?$(e).val(""):$(e).prop("checked",!1)}function bjmform_score_calc(){var e=0;return $("input[bjmf-score]:visible:checked").each(function(){var t=$(this).attr("bjmf-score");try{t=parseFloat(t),isNaN(t)||(e+=t)}catch(e){}}),$("option[bjmf-score]:selected").each(function(){if(0!=$(this).closest("select:visible").length){var t=$(this).attr("bjmf-score");try{t=parseFloat(t),isNaN(t)||(e+=t)}catch(e){}}}),$("#bjmf_score").val(e),e}function bjmform_ini(e,t,a,r){null!=e&&null!=e&&e||(e=[]),null==typeof r&&(r=0),$.each(e,function(e,a){$("[name='"+t+"["+e+"]'][type!=radio]").val(a),$("[name='"+t+"["+e+"]'][type=radio][value='"+a+"']").prop("checked",!0),"object"==typeof a&&$.each(a,function(a,r){$("[name='"+t+"["+e+"][]'][value='"+r+"']").prop("checked",!0),$("[name='"+t+"["+e+"]["+a+"]'][value='"+r+"']").prop("checked",!0),"object"==typeof r&&$.each(r,function(r,n){$("[name='"+t+"["+e+"]["+a+"][]'][value='"+n+"']").prop("checked",!0)})}),$("[name='"+t+"["+e+"][]'][value='"+a+"']").prop("checked",!0)});var n={};$.each(e,function(e,a){$("[name='"+t+"["+e+"]'][type=radio][title='"+a+"']").prop("checked",!0),$("[name='"+t+"["+e+"]']").find("option[title='"+a+"']").prop("selected",!0),"object"==typeof a&&$.each(a,function(a,r){$("[name='"+t+"["+e+"][]'][value='"+r+"']").prop("checked",!0),$("[name='"+t+"["+e+"]["+a+"]'][value='"+r+"']").prop("checked",!0),"object"==typeof r&&$.each(r,function(r,n){$("[name='"+t+"["+e+"]["+a+"][]'][value='"+n+"']").prop("checked",!0)})});var r=$("[name='"+t+"["+e+"]'][field-type=draw][value]");r.length&&(n[e]=r)}),Object.keys(n).length&&render_draw_pad(function(){$.each(n,function(e,t){DrawPad.renderResult(t)})});var o=function(e){var t=[];$("[link_n="+e+"]").each(function(e,a){void 0!==$(this).attr("type")?"text"==$(this).attr("type")?t.push($(this).val().trim()):$(this).prop("checked")&&t.push($(this).parent().text().trim()):t.push($(this).find("option:selected").text().trim())}),$("[linkn="+e+"]").each(function(e,a){var r=JSON.parse($(this).attr("linkv")),n=!1;$.each(r,function(e,a){jQuery.inArray(a,t)>-1&&(n=!0)}),n?$(this).show("fast"):($(this).hide("fast"),$(this).find("input,select").each(function(e,t){bjmform_ele_clear($(this)),$(this).change()}))})};($("[link_n]").bind("change",function(){var e=$(this).attr("link_n");o(e)}),$("[link_n]").each(function(){o($(this).attr("link_n"))}),$("[bjmf-score]").bind("change",function(){var e=$(this).attr("bjmf-score");void 0!==e&&""!=e&&"0"!=e&&bjmform_score_calc()}),$("[bjmfform_address]").length>0)&&loadScript((void 0===window.sitecdn?"//c.d8n.cn":window.sitecdn)+"/res/app_form_address.js?v=5",function(){"undefined"!=typeof bjmform_addr_auto&&bjmform_addr_auto()});var i=$("[name^='"+t+"[']").parents("form, .html-form");if(a)$.each(e,function(e,a){$("[name='"+t+"["+e+"]']").prop("disabled",!0),$("[name='"+t+"["+e+"][]']").prop("disabled",!0),$("[bjmfform_address='"+t+"_"+e+"']").find("select, input").prop("disabled",!0),$("[name='"+t+"["+e+"]']:checked").parent().css("color","var(--primary)"),$("[name='"+t+"["+e+"][]']:checked").parent().css("color","var(--primary)")}),i.find('.form-group[data-type] [name^="fm["]').prop("disabled",!0),i.find(".form_uploadfile").each(function(){_attach_html=bjmf_attachment_format($(this).val()),$(this).after(_attach_html)}),i.find(".form-group[data-type=file] .jFiler-input-dragDrop").hide(),i.find(".form-group[data-type=file] .jFiler-item-trash-action").hide(),i.find("[bmfe] + .draw_btn").hide(),i.find(".jFiler a[onclick^=use_alt_upload]").hide();else{i.find(".form_uploadfile").each(function(){fix_attachments_url(this),html_upload_js($(this).attr("id"),get_current_role(),t)});var d=!1;i.find("[dic]").each(function(){$(this).attr("dic")&&$(this).attr("dic").length>0&&(d=!0)}),d&&loadScript("/res/app_form_dic.js",function(){dic_init()})}}function bjmform_getdata(e,t){return formToJSArray($(e)[0])[t]}function formToJSArray(e){var t=new FormData(e),a={};return t.forEach((e,t)=>{if(t.includes("[]"))for(var r=t.replace("[]","").split("[").map(function(e){return e.replace("]","")}).filter(function(e){return""!==e}),n=a,o=0;o<r.length;o++){var i=r[o];o===r.length-1?(n[i]||(n[i]=[]),n[i].push(e)):(n[i]||(n[i]={}),n=n[i])}else if(t.includes("["))for(r=t.split("[").map(function(e){return e.replace("]","")}),n=a,o=0;o<r.length;o++){i=r[o];o===r.length-1?n[i]=e:(n[i]||(n[i]={}),n=n[i])}else a[t]=e}),a}function mapsel(e){in_wxapp()?($('<div style="position: absolute;left: 0;top: 0;width: 100%;height: 100%;background: #fff;z-index:99999;" id="bjmf_selmap_div"><iframe id="mapPage" width="100%" height="100%" frameborder=0 src="/'+gconfig.role+'/plugin/mapsel"></iframe>').appendTo("body"),window.bjmf_plugin_selok=function(t,a){$(e).val(t).trigger("change"),$("#bjmf_selmap_div").remove()}):($('<div style="position: absolute;left: 0;top: 0;width: 100%;height: 100%;background: #fff;z-index:99999;" id="bjmf_selmap_div"><iframe id="mapPage" width="100%" height="100%" frameborder=0 src="https://apis.map.qq.com/tools/locpicker?search=1&type=1&key=ERQBZ-FFAR5-W4XI6-IT7FK-EB5PF-SJBG4&referer=myapp"></iframe>').appendTo("body"),setTimeout(function(){$("#bjmf_selmap_div").height($(window).height()),$("#bjmf_selmap_div").width($(window).width()),window.addEventListener("message",function(t){var a=t.data;a&&"locationPicker"==a.module&&(console.log("location",a),$("#bjmf_selmap_div").hide(),_addr=a.poiaddress+"|"+a.latlng.lat.toFixed(5)+","+a.latlng.lng.toFixed(5),$(e).val(_addr).trigger("change"),$("#bjmf_selmap_div").remove())},!1)},2e3))}$(function(){$(".menu-list2 .cell > a").on("click",function(){countFavoriteLink(this)})}),wx_readyed=!1;var geo_quick=[{range:[35.3236,35.3321,113.9075,113.9225],addr:"河南省,新乡市,牧野区,河南师范大学"},{range:[22.5847,22.5896,113.9664,113.9763],addr:"广东省,深圳市,南山区,哈尔滨工业大学(深圳)"},{range:[39.542,39.548,117.389,117.403],addr:"天津市,天津市,宝坻区,北京科技大学天津学院"},{range:[35.29468,35.2991,114.06565,114.07241],addr:"河南省,新乡市,红旗区,新联学院"},{range:[21.16,21.169,110.237,110.252],addr:"广东省,湛江市,麻章区,广东海洋大学寸金学院(新湖校区)"},{range:[36.17,36.1744,120.434,120.44],addr:"山东省,青岛市,李沧区,巨峰路山东外贸职业学院"},{range:[23.141,23.1453,113.3144,113.324],addr:"广东省,广州市,天河区,广州体育学院"},{range:[24.073,24.079,117.531,117.541],addr:"福建省,漳州市,漳浦县,漳州科技学院"},{range:[23.366,23.3705,113.4255,113.431],addr:"广东省,广州市,白云区,广东行政职业学院（白云校区）"},{range:[27.806,27.812,114.886,114.897],addr:"江西省,新余市,渝水区,江西工程学院（天工校区）"},{range:[25.667,25.673,100.292,100.298],addr:"云南省,大理白族自治州,大理市,滇西应用技术大学"},{range:[27.772,27.779,114.841,114.852],addr:"江西省,新余市,渝水区,江西工程学院科技园"},{range:[23.3983,23.4022,113.1848,113.1885],addr:"广东省,广州市,花都区,广东行政职业学院"},{range:[25.8473,25.8514,114.93,114.9323],addr:"江西省,赣州市,章贡区,章贡区赣南师范大学科技学院"},{range:[28.8108,28.8147,111.939,111.944],addr:"湖南省,常德市,汉寿县,湖南高尔夫旅游职业学院"},{range:[30.7463,30.7509,108.4408,108.4565],addr:"重庆市,重庆市,万州区,重庆三峡学院(百安校区)"},{range:[30.7463,30.7563,108.4492,108.4565],addr:"重庆市,重庆市,万州区,重庆三峡学院(百安校区)"},{range:[31.6231,31.63033,118.8976,118.9078],addr:"江苏省,南京市,溧水区,江苏第二师范学院(石湫校区)"},{range:[36.074,36.0757,120.38295,120.385],addr:"山东省,青岛市,市南区,山东外贸职业学院(南校区)"},{range:[38.3815,38.3895,117.3089,117.32],addr:"河北省,沧州市,黄骅市,沧州交通学院"},{range:[34.1326,34.1353,113.8275,113.8297],addr:"河南省,许昌市,建安区,许昌陶瓷职业学院"},{range:[23.1054,23.0983,113.4773,113.4807],addr:"广东省,广州市,黄埔区,广州航海学院红山三路校区"},{range:[44.0711,44.0746,125.1754,125.1816],addr:"吉林省,长春市,宽城区,吉林司法警官职业学院"},{range:[30.435868,30.444634,114.309959,114.321035],addr:"湖北省,武汉市,洪山区,武汉城市职业学院(南校区)"},{range:[30.474896,30.478182,114.319496,114.325525],addr:"湖北省,武汉市,洪山区,武汉城市职业学院(北校区)"},{range:[23.30017,23.30699,113.56544,113.57191],addr:"广东省,广州市,黄埔区,广州商学院"},{range:[23.30699,23.31442,113.56336,113.56793],addr:"广东省,广州市,黄埔区,广州商学院"},{range:[27.82695,27.83103,113.16986,113.1754],addr:"湖南省,株洲市,荷塘区,湖南工业大学"},{range:[29.14309,29.14782,120.32745,120.3338],addr:"浙江省,金华市,东阳市,浙江横店影视职业学院(都督南街校区)"},{range:[29.02873,29.03822,106.68933,106.69566],addr:"重庆市,重庆市,綦江区,重庆外语外事学院(綦江校区)"},{range:[26.03173,26.03918,119.19022,119.19959],addr:"福建省,福州市,闽侯县,福建理工大学(旗山校区北校区)"},{range:[22.83352,22.83759,108.34769,108.35115],addr:"广西壮族自治区,南宁市,兴宁区,南宁师范大学(长堽校区)"},{range:[26.19075,26.20105,117.56141,117.56764],addr:"福建省,三明市,三元区,三明学院"},{range:[30.70825,30.71802,114.52106,114.5322],addr:"湖北省,武汉市,新洲区,武汉生物工程学院"},{range:[27.71812,27.72699,107.08337,107.08777],addr:"贵州省,遵义市,红花岗区,遵义医学院医学与科技学院"},{range:[30.49913,30.50486,114.38701,114.39326],addr:"湖北省,武汉市,洪山区,武汉工程大学"},{range:[38.50087,38.50543,106.12431,106.14908],addr:"宁夏回族自治区,银川市,西夏区,宁夏大学"},{range:[38.49092,38.50087,106.13697,106.14589],addr:"宁夏回族自治区,银川市,西夏区,宁夏大学"},{range:[34.11154,34.11989,108.93876,108.94497],addr:"陕西省,西安市,长安区,西安信息大学"},{range:[30.50938,30.51737,103.59443,103.60139],addr:"四川省,成都市,大邑县,四川电影电视学院(安仁校区)"},{range:[33.63155,33.64222,114.67777,114.68812],addr:"河南省,周口市,川汇区,周口师范学院"},{range:[27.81343,27.82577,113.0957,113.1142],addr:"湖南省,株洲市,天元区,湖南工业大学（新校区）"},{range:[35.18275,35.19262,113.25781,113.27541],addr:"河南省,焦作市,山阳区,河南理工大学"},{range:[38.29251,38.29744,116.79961,116.81035],addr:"河北省,沧州市,运河区,河北水利电力学院"},{range:[18.32319,18.34175,109.55015,109.56434],addr:"海南省,三亚市,吉阳区,三亚学院"},{range:[23.16349,23.1707,108.16407,108.16995],addr:"广西壮族自治区,南宁市,武鸣区,广西国际商务职业技术学院东盟校区"},{range:[30.84217,30.84958,104.46023,104.46779],addr:"四川省,成都市,金堂县,成都文理学院"},{range:[34.10855,34.11431,108.72578,108.73367],addr:"陕西省,西安市,鄠邑区,西安医学高等专科学校"},{range:[23.03255,23.04479,113.38348,113.40302],addr:"广东省,广州市,番禺区,广东工业大学"},{range:[39.58826,39.59847,116.74633,116.75874],addr:"河北省,廊坊市,广阳区,河北东方学院"},{range:[23.04495,23.05013,112.90718,112.91312],addr:"广东省,佛山市,南海区,广东环境保护工程职业学院"},{range:[36.6592,36.66787,117.47761,117.48488],addr:"山东省,济南市,章丘区,章丘区山东传媒职业学院(章丘校区)"},{range:[30.36839,30.37375,114.40282,114.40897],addr:"湖北省,武汉市,江夏区,湖北水利水电职业技术学院"},{range:[37.19115,37.19382,117.11546,117.12021],addr:"山东省,济南市,商河县,山东工程职业技术大学(北校区)"},{range:[29.6075,29.61679,106.29486,106.30786],addr:"重庆市,重庆市,沙坪坝区,重庆师范大学(大学城校区)"},{range:[43.81852,43.82148,125.25824,125.26413],addr:"吉林省,长春市,朝阳区,吉林动画学院"},{range:[25.23321,25.2358,103.00175,103.0064],addr:"云南省,昆明市,嵩明县,云南城市建设职业学院"},{range:[46.69032,46.69504,131.16701,131.17672],addr:"黑龙江省,双鸭山市,尖山区,黑龙江能源职业学院"},{range:[38.94779,38.95866,117.05474,117.06389],addr:"天津市,天津市,静海区,天津体育学院(新校区)"},{range:[30.1939,30.19981,104.07629,104.08159],addr:"四川省,眉山市,仁寿县,通用航空职业学院"},{range:[25.99362,25.99695,119.37046,119.3743],addr:"福建省,福州市,仓山区,闽江师范高等专科学校(仓山校区)"},{range:[39.80432,39.80948,118.1654,118.17433],addr:"河北省,唐山市,丰润区,华北理工大学轻工学院(新校区)"},{range:[36.15835,36.16396,117.01,117.01383],addr:"山东省,泰安市,岱岳区,山东外贸职业学院(泰安)"},{range:[24.64472,24.65088,102.61543,102.63008],addr:"云南省,昆明市,晋宁区,昆明卫生职业学院"},{range:[24.85537,24.86678,102.84401,102.86367],addr:"云南省,昆明市,呈贡区,云南师范大学呈贡校区"},{range:[32.4617,32.46722,119.93557,119.94703],addr:"江苏省,泰州市,海陵区,南京理工大学(泰州科技学院)"},{range:[22.78269,22.79085,113.22286,113.23413],addr:"广东省,佛山市,顺德区,南方医科大学(顺德校区)"},{range:[30.47587,30.48486,114.44175,114.45566],addr:"湖北省,武汉市,江夏区,湖北第二师范学院"},{range:[31.66923,31.6779,118.55059,118.56039],addr:"安徽省,马鞍山市,花山区,安徽工业大学(东校区)"},{range:[28.06207,28.07252,113.0014,113.01385],addr:"湖南省,长沙市,天心区,长沙理工大学(云塘校区)"},{range:[31.31689,31.32326,120.41324,120.4204],addr:"江苏省,苏州市,虎丘区,苏州高博软件技术职业学院"},{range:[23.1826,23.18777,113.32965,113.33671],addr:"广东省,广州市,白云区,南方医科大学(广州校区)"},{range:[27.68924,27.69426,113.53549,113.54163],addr:"湖南省,株洲市,醴陵市,湖南工业大学醴陵陶瓷学院"},{range:[36.67217,36.6882,117.17861,117.19269],addr:"山东省,济南市,历城区,山东建筑大学"},{range:[34.45031,34.45547,113.70678,113.70967],addr:"河南省,郑州市,新郑市,郑州时代科技中等专业学校"},{range:[33.0628,33.06758,113.98828,113.99391],addr:"河南省,驻马店市,驿城区,驻马店幼儿师范高等专科学校"},{range:[39.19747,39.21685,118.58108,118.6025],addr:"河北省,唐山市,曹妃甸区,华北理工大学"},{range:[30.31549,30.32128,114.0437,114.05057],addr:"湖北省,武汉市,汉南区,湖北国土资源职业学院(汉南新校区)"},{range:[30.87494,30.88136,120.1276,120.13779],addr:"浙江省,湖州市,吴兴区,湖州职业技术学院"},{range:[22.79685,22.80411,108.51258,108.51862],addr:"广西壮族自治区,南宁市,青秀区,广西外国语学院(五合校区)"},{range:[43.82002,43.82967,126.49409,126.51395],addr:"吉林省,吉林市,船营区,东北电力大学"},{range:[25.49734,25.50425,119.08522,119.09413],addr:"福建省,莆田市,涵江区,湄洲湾职业技术学院"},{range:[25.27493,25.28205,110.36952,110.37845],addr:"广西壮族自治区,桂林市,七星区,桂林航天工业学院"},{range:[43.8779,43.87994,125.44698,125.44987],addr:"吉林省,长春市,二道区,长春光华学院（新校区）"},{range:[33.81902,33.82781,113.07181,113.08081],addr:"河南省,平顶山市,宝丰县,平顶山职业技术学院"},{range:[26.26041,26.2671,111.62676,111.63388],addr:"湖南省,永州市,零陵区,永州师范高等专科学校"},{range:[26.07154,26.07766,119.26459,119.27474],addr:"福建省,福州市,鼓楼区,福州大学至诚学院店"},{range:[24.93357,24.93898,102.8942,102.90046],addr:"云南省,昆明市,呈贡区,昆明传媒学院"},{range:[29.93653,29.94684,113.96485,113.98141],addr:"湖北省,咸宁市,嘉鱼县,武汉东湖学院南校区"},{range:[21.6396,21.64863,110.22541,110.23238],addr:"广东省,湛江市,廉江市,广东司法警官职业学院(廉江校区)广东文理职业学院"},{range:[30.89804,30.90505,121.88531,121.89707],addr:"上海市,上海市,浦东新区,上海电力大学临港校区"},{range:[45.85593,45.86037,126.54633,126.55548],addr:"黑龙江省,哈尔滨市,呼兰区,黑龙江外国语学院"},{range:[31.00535,31.00959,104.23309,104.23972],addr:"四川省,德阳市,广汉市,四川航天职业技术学院"},{range:[30.61137,30.62192,105.24185,105.25085],addr:"四川省,遂宁市,大英县,四川文轩职业学院大英校区"},{range:[38.38047,38.3887,117.43873,117.44706],addr:"河北省,沧州市,黄骅市,北京中医药大学东方学院"},{range:[36.0926,36.09559,103.69104,103.69566],addr:"甘肃省,兰州市,安宁区,兰州城市学院"},{range:[40.60541,40.61317,109.9774,109.98726],addr:"内蒙古自治区,包头市,东河区,包头医学院"},{range:[23.15992,23.17249,108.24292,108.25092],addr:"广西壮族自治区,南宁市,武鸣区,广西医科大学"},{range:[29.3562,29.36211,106.53546,106.54366],addr:"重庆市,重庆市,巴南区,重庆五一职业技术学院"},{range:[36.05127,36.0624,103.72888,103.74234],addr:"甘肃省,兰州市,七里河区,兰州理工大学(彭家坪校区)"},{range:[22.62123,22.62767,107.98645,107.99478],addr:"广西壮族自治区,崇左市,扶绥县,广西外国语学院(空港校区)"},{range:[39.00709,39.01557,117.38057,117.39381],addr:"天津市,天津市,津南区,天津中德应用技术大学"},{range:[41.92722,41.93371,123.58864,123.59412],addr:"辽宁省,沈阳市,沈北新区,辽宁现代服务职业技术学院"},{range:[41.96334,41.9714,123.36894,123.37967],addr:"辽宁省,沈阳市,沈北新区,辽宁传媒学院(北校区)"},{range:[29.66184,29.66724,106.60374,106.61191],addr:"重庆市,重庆市,渝北区,川外南方翻译"},{range:[29.37089,29.37689,105.87331,105.88207],addr:"重庆市,重庆市,永川区,重庆科创职业学院"},{range:[32.90108,32.91026,117.42757,117.43431],addr:"安徽省,蚌埠市,龙子湖区,蚌埠医学院(龙子湖校区)"},{range:[28.64712,28.65208,115.8957,115.90012],addr:"江西省,南昌市,西湖区,江西工程职业学院"},{range:[34.82281,34.82877,114.33632,114.3416],addr:"河南省,开封市,龙亭区,开封教育学院6号楼教学"},{range:[45.71836,45.72456,126.73261,126.7404],addr:"黑龙江省,哈尔滨市,香坊区,哈尔滨金融学院"},{range:[39.1598,39.16379,116.97224,116.97794],addr:"天津市,天津市,西青区,天津农学院(西校区)"},{range:[39.08869,39.09427,117.09868,117.10464],addr:"天津市,天津市,西青区,天津农学院(东校区)"},{range:[30.78566,30.78922,108.37552,108.38306],addr:"重庆市,重庆市,万州区,重庆信息技术职业学院(金龙校区)"},{range:[36.23612,36.24309,120.01763,120.0228],addr:"山东省,青岛市,胶州市,青岛工学院"},{range:[41.72194,41.73248,123.48178,123.50524],addr:"辽宁省,沈阳市,浑南区,沈阳理工大学"},{range:[32.32124,32.33214,119.42649,119.43908],addr:"江苏省,扬州市,邗江区,江海学院"},{range:[26.07284,26.07604,119.1561,119.16478],addr:"福建省,福州市,闽侯县,福州职业技术学院"},{range:[38.01587,38.02529,114.54658,114.55497],addr:"河北省,石家庄市,裕华区,河北地质大学"},{range:[31.74431,31.74895,117.02797,117.03492],addr:"安徽省,合肥市,肥西县,合肥科技职业学院"},{range:[31.73647,31.74221,117.01965,117.02716],addr:"安徽省,合肥市,肥西县,安徽外国语学院"},{range:[34.20996,34.21549,109.10183,109.10602],addr:"陕西省,西安市,灞桥区,西安汽车职业大学"},{range:[41.93265,41.94103,123.50639,123.51543],addr:"辽宁省,沈阳市,沈北新区,辽宁省交通高等专科学校"},{range:[32.0542,32.05903,118.75113,118.75606],addr:"江苏省,南京市,鼓楼区,江苏第二师范学院草场门校区"},{range:[22.93211,22.93845,113.72267,113.72819],addr:"广东省,东莞市,东莞市,广东创新科技职业学院"},{range:[36.73855,36.74959,101.74415,101.75448],addr:"青海省,西宁市,城北区,青海师范大学(城北校区)"},{range:[27.94348,27.9502,102.20848,102.21799],addr:"四川省,凉山彝族自治州,西昌市,西昌学院(安宁校区)"},{range:[33.56561,33.57047,114.0046,114.01368],addr:"河南省,漯河市,源汇区,漯河职业技术学院"},{range:[28.15105,28.16025,112.97134,112.98149],addr:"湖南省,长沙市,天心区,长沙理工大学(金盆岭校区)"},{range:[38.9634,38.97829,106.40124,106.42295],addr:"宁夏回族自治区,石嘴山市,大武口区,宁夏理工学院"},{range:[37.47655,37.48306,121.4362,121.44514],addr:"山东省,烟台市,莱山区,山东工商学院(西校区)"},{range:[24.87811,24.88842,102.43586,102.44648],addr:"云南省,昆明市,安宁市,昆明冶金高等专科学校(安宁校区)"},{range:[36.66042,36.67131,119.02903,119.03947],addr:"山东省,潍坊市,潍城区,山东第二医科大学（新校区）"},{range:[25.11768,25.12836,110.29518,110.30641],addr:"广西壮族自治区,桂林市,雁山区,桂林旅游学院"},{range:[31.25726,31.2601,120.8693,120.87322],addr:"江苏省,苏州市,吴中区,企业"},{range:[24.59737,24.60434,118.24956,118.25619],addr:"福建省,厦门市,翔安区,厦门南洋职业学院"},{range:[22.97761,22.98209,116.32043,116.33266],addr:"广东省,揭阳市,惠来县,广东工业大学(揭阳校区)"},{range:[39.75025,39.76129,116.36726,116.37774],addr:"北京市,北京市,大兴区,北京社会管理职业学院(新校区)"},{range:[28.8264,28.83701,104.93747,104.94707],addr:"四川省,宜宾市,南溪区,现代农业学院宜宾职业技术学院"},{range:[35.12613,35.1304,110.91365,110.9221],addr:"山西省,运城市,盐湖区,运城师范高等专科学校"},{range:[37.65044,37.66,121.11413,121.1211],addr:"山东省,烟台市,福山区,烟台船舶工业学校"},{range:[31.13301,31.13871,118.62639,118.63688],addr:"安徽省,芜湖市,湾沚区,安徽信息工程学院(新芜校区)"},{range:[30.0779,30.08486,104.68266,104.6906],addr:"四川省,资阳市,雁江区,资阳环境科技职业学院"},{range:[33.90695,33.91301,116.86935,116.88576],addr:"安徽省,淮北市,烈山区,淮北师范大学(滨湖校区)"},{range:[34.43961,34.44614,109.17653,109.18506],addr:"陕西省,西安市,临潼区,临潼区西安汽车职业大学(临潼校区)"},{range:[31.67527,31.68124,119.94327,119.95039],addr:"江苏省,常州市,武进区,常州机电职业技术学院"},{range:[30.89724,30.90365,106.15989,106.16854],addr:"四川省,南充市,顺庆区,顺庆区南充电影工业职业学院"},{range:[30.77781,30.78227,106.1248,106.13359],addr:"四川省,南充市,高坪区,川北医学院(高坪校区)"},{range:[33.73263,33.73487,113.30966,113.31357],addr:"河南省,平顶山市,卫东区,平顶山职业技术学院园丁校区"},{range:[25.05319,25.05844,102.69351,102.69908],addr:"云南省,昆明市,五华区,云南师范大学西南联大校区"},{range:[36.84247,36.84885,117.92906,117.94057],addr:"山东省,淄博市,周村区,山东农业工程学院(淄博校区)"},{range:[30.34272,30.34798,114.33438,114.33973],addr:"湖北省,武汉市,江夏区,湖北生态工程职业技术学院湖北生态学院"},{range:[30.826,30.83135,103.57288,103.58231],addr:"四川省,成都市,都江堰市,成都外国语学院"},{range:[28.44494,28.45255,115.95034,115.96066],addr:"江西省,南昌市,南昌县,江西工商职业技术学院"},{range:[30.7189,30.72395,104.02231,104.02747],addr:"四川省,成都市,金牛区,四川电影电视学院(金牛校区)"},{range:[36.10252,36.10585,103.74121,103.74507],addr:"甘肃省,兰州市,安宁区,安宁区兰州城市学院(培黎校区)"},{range:[36.79713,36.80229,117.19496,117.20014],addr:"山东省,济南市,历城区,山东协和学院(遥墙校区)"},{range:[30.66876,30.68478,104.13732,104.1562],addr:"四川省,成都市,成华区,成都理工大学"},{range:[27.18951,27.20359,111.42598,111.44557],addr:"湖南省,邵阳市,大祥区,邵阳学院"},{range:[38.84431,38.85361,121.44166,121.4482],addr:"辽宁省,大连市,旅顺口区,大连东软信息学院（博川校区）"},{range:[39.74391,39.75298,116.28191,116.29058],addr:"北京市,北京市,大兴区,北京建筑大学(大兴校区)"},{range:[45.82021,45.82459,126.50523,126.51606],addr:"黑龙江省,哈尔滨市,松北区,哈医大四院"},{range:[34.61209,34.61947,113.71513,113.72447],addr:"河南省,郑州市,新郑市,郑州经贸学院"},{range:[30.72153,30.7307,103.94549,103.95605],addr:"四川省,成都市,郫都区,成都锦城学院"},{range:[30.81727,30.82197,103.98144,103.99282],addr:"四川省,成都市,郫都区,四川工商学院"},{range:[45.4989,45.50348,126.95918,126.96905],addr:"黑龙江省,哈尔滨市,阿城区,黑龙江护理高等专科学校(阿城校区)"},{range:[31.07675,31.08001,114.57468,114.57808],addr:"湖北省,黄冈市,红安县,武汉城市学院"},{range:[29.85455,29.85959,106.05939,106.06913],addr:"重庆市,重庆市,铜梁区,重庆艺术工程职业学院(铜梁校区)"},{range:[46.62171,46.62657,126.97299,126.98307],addr:"黑龙江省,绥化市,北林区,绥化学院"},{range:[34.33667,34.34434,107.29402,107.30076],addr:"陕西省,宝鸡市,渭滨区,宝鸡职业技术学院"},{range:[22.52435,22.53063,113.38643,113.39406],addr:"广东省,中山市,中山市,电子科技大学中山学院"}];function gps_in_range(e,t,a){return e>=a[0]&&e<=a[1]&&t>=a[2]&&t<=a[3]}function gps_in_ranges(e,t,a){var r=!1;return $.each(a,function(a,n){gps_in_range(e,t,n)&&(r=!0)}),r}function gps_in_ranges_compatible(e,t){if(!e||!t)return null;var a,r;if("string"==typeof e&&(e=e.split(",")),$.isArray(e)?(a=e[0],r=e[1]):$.isPlainObject(e)&&(a=e.lat||e.latitude,r=e.lng||e.longitude),!a||!r)return null;a=parseFloat(a),r=parseFloat(r);var n=!1;if($.isArray(t))gps_in_ranges(a,r,t)&&(n=!0);else{if(null===t.lat||null===t.lng||null===t.radius)return null;geoDistance(a,r,t.lat,t.lng)<=t.radius&&(n=!0)}return n}function bjmf_geo_code_parse(e){var t="",a="",r="";if(void 0!==e.type&&"quick"==e.type)t=e.addr,a=parseFloat(e.lat).toFixed(5),r=parseFloat(e.lng).toFixed(5);else if(void 0!==e.type&&"local"==e.type)t=e.addr,a=parseFloat(e.lat).toFixed(5),r=parseFloat(e.lng).toFixed(5);else if(void 0!==e.from)a=parseFloat(e.lat).toFixed(5),r=parseFloat(e.lng).toFixed(5),t=e.addr;else if(void 0!==e.regeocode){var n=(o=e.regeocode.addressComponent).streetNumber.location.split(",");a=parseFloat(n[1]).toFixed(5),r=parseFloat(n[0]).toFixed(5),t=o.province+","+o.city+","+o.district+","+o.streetNumber.street,"string"==typeof e.regeocode.formatted_address&&(t+=e.regeocode.formatted_address.replace(o.province+o.city+o.district,"").replace(o.township,""))}else{a=e.result.location.lat.toFixed(5),r=e.result.location.lng.toFixed(5);var o={};void 0!==e.result.address_component&&(o=e.result.address_component),void 0!==e.result.addressComponent&&(o=e.result.addressComponent),t=o.province+","+o.city+","+o.district+","+o.street+o.street_number.replace(o.street,""),void 0!==e.result.formatted_addresses&&void 0!==e.result.formatted_addresses.recommend&&(t+=e.result.formatted_addresses.recommend)}return{lat:a,lng:r,addr:t,addr4bjmf:t+"|"+a+","+r}}function autogps(e,t){if(void 0===e&&(e="[bjmfform_autogps]"),void 0===t&&(t=!0),navigator.userAgent.indexOf("MicroMessenger")>-1){if(wx_readyed)return autogps_cb(e,t);if("undefined"!=typeof wx_js_sign_data&&void 0!==wx_js_sign_data.nonceStr){if("undefined"!=typeof wx_js_signed_by_myself&&wx_js_signed_by_myself)return;return wx.ready(function(){wx_readyed=!0,autogps_cb(e,t)}),void wx.config(wx_js_sign_data)}loadScript("//res.wx.qq.com/open/js/jweixin-1.6.0.js",function(){$.get("/weixin/jsticket?url="+encodeURIComponent(document.location.href),function(a){wx.ready(function(){wx_readyed=!0,autogps_cb(e,t)}),wx.config({debug:!1,appId:a.appId,timestamp:a.timestamp,nonceStr:a.nonceStr,signature:a.signature,jsApiList:["checkJsApi","openLocation","getLocation","getNetworkType"]})},"json")})}else alert("无法自动获取位置，建议在微信中打开以自动获取位置")}function loadWeChat(e,t,a){if(navigator.userAgent.indexOf("MicroMessenger")>-1){if(wx_readyed&&!t)return;loadScript("//res.wx.qq.com/open/js/jweixin-1.6.0.js",function(){$.get("/weixin/jsticket?url="+encodeURIComponent(document.location.href),function(e){wx.ready(function(){wx_readyed=!0,a&&a()});var r=["checkJsApi","openLocation","getLocation","getNetworkType"];t&&(r=r.concat(t)),wx.config({debug:!1,appId:e.appId,timestamp:e.timestamp,nonceStr:e.nonceStr,signature:e.signature,jsApiList:r})},"json")})}else e&&alert("建议在微信中打开该页面。")}function localgeo(e){if(window.localStorage){var t=[],a=window.localStorage.getItem("geos");if(a)try{t=JSON.parse(a)}catch(e){console.log("localStorageJSON error")}var r=!1;return $.each(t,function(t,a){var n=Math.abs(parseFloat(a.lat)-parseFloat(e.lat)),o=Math.abs(parseFloat(a.lng)-parseFloat(e.lng));n<=1e-4&&o<=1e-4&&(r=a)}),void 0===e.addr?!1!==r?(e.addr=r.addr,e):null:(!1===r&&(t.push(e),window.localStorage.setItem("geos",JSON.stringify(t))),e)}return null}function bjmf_geo_code_cb(e){"undefined"==typeof bjmf_geo_code?console.log("未定义bjmf_geo_code",e):(localgeo(bjmf_geo_code_parse(e)),bjmf_geo_code(e))}function bjmf_geo_code_cb_self(e){bjmf_geo_code_cb(e)}function bjmf_geo_code_cb_baidu(e){bjmf_geo_code_cb(e)}function bjmf_geo_code_cb_amap(e){bjmf_geo_code_cb(e)}function autogps_cb(e,t){void 0===e&&(e="[bjmfform_autogps]"),void 0===t&&(t=!0),networkType="nothing",wx.getNetworkType({success:function(e){networkType=e.networkType}}),ret=wx.getLocation({type:"gcj02",success:function(a){if("undefined"==typeof bjmf_geo_code&&(window.bjmf_geo_code=function(t){var a=bjmf_geo_code_parse(t);void 0===e&&(e="[bjmfform_autogps]"),$(e).length>0&&$(e).val(a.addr4bjmf)}),!t)return bjmf_geo_code({type:"quick",addr:"",lat:a.latitude,lng:a.longitude});$(e).length>0&&($(e).val("|"+parseFloat(a.latitude).toFixed(5)+","+parseFloat(a.longitude).toFixed(5)),$(".autogps_btn_area").html("已成功获取位置"));var r=localgeo({type:"quick",lat:a.latitude,lng:a.longitude});if(null===r){var n=!1;if($.each(geo_quick,function(e,t){n||gps_in_range(a.latitude,a.longitude,t.range)&&(n=!0,bjmf_geo_code({type:"quick",addr:t.addr,lat:a.latitude,lng:a.longitude}))}),!n)if("undefined"!=typeof COURSE_ID&&COURSE_ID%10<=10)$.ajax({url:"//examtools.kjfdb.com/geocode.php?lat="+a.latitude+"&lng="+a.longitude,dataType:"json",success:function(e){bjmf_geo_code_cb_self(e)},error:function(e){console.log(e),bjmf_geo_code({type:"quick",addr:"地址,解析,失败,SELF",lat:a.latitude,lng:a.longitude})}});else if("undefined"!=typeof COURSE_ID&&COURSE_ID%10<=8)$.ajax({url:"https://restapi.amap.com/v3/geocode/regeo?output=json&key=03dcba0cb6aee4a3695363b724de0708&location="+a.longitude+","+a.latitude,dataType:"jsonp",jsonpCallback:"bjmf_geo_code_cb_amap",success:function(e){bjmf_geo_code_cb_amap(e)},error:function(e){console.log(e),bjmf_geo_code({type:"quick",addr:"地址,解析,失败,AMAP",lat:a.latitude,lng:a.longitude})}});else{var o={location:a.latitude+","+a.longitude,key:"ERQBZ-FFAR5-W4XI6-IT7FK-EB5PF-SJBG4",get_poi:0,output:"jsonp"};$.ajax({type:"get",url:"https://apis.map.qq.com/ws/geocoder/v1",data:o,dataType:"jsonp",jsonpCallback:"bjmf_geo_code_cb",success:function(e){bjmf_geo_code_cb(e)},error:function(e){console.log(e),bjmf_geo_code({type:"quick",addr:"地址,解析,失败,QMAP",lat:a.latitude,lng:a.longitude})}})}}else bjmf_geo_code(r)},fail:function(e){"wifi"!=networkType?alert("获取位置失败（"+JSON.stringify(e)+"），可打开WIFI和定位后再尝试"):alert("获取位置失败（"+JSON.stringify(e)+"），可进行以下操作后再尝试：打开手机定位和授权微信定位权限")},complete:function(e){console.log("complete")},cancel:function(e){console.log("cancel"),alert("已取消，如果需要获取，还可以点上方“自动获取位置”按钮重试")}})}function bjmform_checkform(e){_needfilla=[];var t=$(e).closest("form");return!!t.length&&(t.hasClass("layui-form")?findSelector="div.layui-form-item:visible [bmfe]":findSelector="div.form-group:visible [bmfe]",t.find(findSelector).each(function(){_t=$(this),_required=!(void 0===_t.attr("bmneed")),_required&&(_v="",void 0===_t.attr("type")||"radio"!=_t.attr("type")&&"checkbox"!=_t.attr("type")?(_v=_t.val(),null===_v&&(_v="")):$("[name='"+_t.attr("name")+"']:checked").length>0&&(_v=$("[name='"+_t.attr("name")+"']:checked").val()),_fillvalue=_t.attr("name"),_v.trim().length<1&&-1==jQuery.inArray(_fillvalue,_needfilla)&&_needfilla.push(_fillvalue))}),_needfilla.length>0?(alert("还有"+_needfilla.length+"项必填项没有填写，填写后再提交"),!1):(bjmform_score_calc(),$("[type=file]").remove(),!0))}function bjmf_rdochk_ini(){bjmf_rdochecked(".bjmfrdochk"),$(".rdobox").unbind("click",bjmf_rdochecked_rdo).bind("click",bjmf_rdochecked_rdo),$(".chkbox").unbind("click",bjmf_rdochecked_chk).bind("click",bjmf_rdochecked_chk)}function bjmf_rdochecked_rdo(){$(this).prev().prop("checked","checked"),bjmf_rdochecked(".bjmfrdochk")}function bjmf_rdochecked_chk(){1==$(this).prev().prop("checked")?$(this).prev().removeAttr("checked"):$(this).prev().prop("checked","checked"),bjmf_rdochecked(".bjmfrdochk"),"undefined"!=typeof cb_bjmf_rdochecked_chged&&cb_bjmf_rdochecked_chged($(this).prev())}function bjmf_rdochecked(e){$(e).each(function(t){var a=$(e).eq(t).next();0==$(e).eq(t).prop("checked")?(a.removeClass("checked"),a.addClass("unchecked"),a.find(".check-image").css("background","url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAbUExURQAAALW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tW01flwAAAAIdFJOUwDtBpHukImILT7eIAAAACdJREFUCNdjYCANMBk6K4AZrB0dBWAGY0eHACoDKJUAUWwCVUw8AADNiwZs9OOD8wAAAABJRU5ErkJggg==)")):(a.removeClass("unchecked"),a.addClass("checked"),a.find(".check-image").css("background","url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAABmUExURQAAAP///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////5WfaagAAAAhdFJOUwCenbkBCpUCA6ShB5+qkLSbkqu9mqIEpoqEiMCWCZy4mI+19xIAAABoSURBVCjPpY83FsMwFMPgIn/J6b0X3P+SWZJnZ8gUblhAEv5LPB/pi+/ajLlWq4H3M7VruZUzALlX+wwXPQJ5p04DuKonclGrAIiiztdqHW/5QVVX7Uc/aVSXMRSmjW5jPDEtuvbnnxeJXQfKWoecZgAAAABJRU5ErkJggg==)"))})}function fix_attachments_url(e){if(e.value&&!e.value.startsWith("[{")){var t=e.value.split(",");if(1!==t.length||t[0]){var a=[];$.each(t,function(e,t){a.push({name:"附件 "+(e+1),file:t,size:1,type:""})}),e.value=JSON.stringify(a)}}}function wxtask_noticeadd_cb(e){return void 0===e.s?"请求返回异常":"ok"==e.s?"已开始提醒":"repeat"==e.s?"已提醒过，一个事件的全员提醒，一天只能提醒一次":""}function wxtask_notice(e,t,a,r,n){_postdata={flag:t,url:a,title:r},""==dealUndefined(n)?_postdata.courseids=e:_postdata.groupids=n,$.post("/teacher/course/"+e+"/wxtasknotice",_postdata,function(e){alert(wxtask_noticeadd_cb(e))},"json")}function pick_event_ask2add(e){bjmf_prompt(e.title,function(t){pick_event_add(e.course_id,e.flag,e.studentids,t,e.remark)},e.defaultv)}function pick_event_add(e,t,a,r,n){var o={flag:t,studentids:a,v:r,name:n},i="/teacher/picks/course/"+e+"/quick";gconfig&&gconfig.role&&"org"==gconfig.role&&(i="/org/picks/quick",o.course_id=e),$.post(i,o,function(e){void 0===e.s&&alert("请求返回异常，可尝试重试"),"ok"==e.s&&alert("已完成批量记分"),"repeat"==e.s&&alert("当前事件已记分过一遍啦")},"json")}function dealUndefined(e){return void 0===e?(console.log("something undefined"),""):e}function renderPagination(){var e=window.__pagination__;if(e)if(window.layui)layui.use(["laypage"],function(){layui.laypage.render({elem:"pagination",limit:e.limit,curr:e.page,count:e.total,jump:function(e,t){t||(location.href="?limit="+e.limit+"&page="+e.curr)}})});else{var t=$("#pagination");t.html('<ul class="pagination justify-content-center my-3">\n    <li class="page-item first disabled">\n      <a class="page-link" href="#">首页</a>\n    </li>\n    <li class="page-item prev disabled"><a class="page-link" href="#">上一页</a></li>\n    <li class="page-item current"><a class="page-link" href="#">1</a></li>\n    <li class="page-item next disabled"><a class="page-link" href="#">下一页</a></li>\n    <li class="page-item last disabled">\n      <a class="page-link" href="#">末页</a>\n    </li>\n  </ul>');var a="?limit="+e.limit+"&page=",r=t.find(".page-item");r.filter(".current").find("a").text(e.page).attr("href",a+e.page),e.page>1&&(r.filter(".prev").removeClass("disabled").find("a").attr("href",a+(e.page-1)),r.filter(".first").removeClass("disabled").find("a").attr("href",a+1)),e.page*e.limit<e.total&&(r.filter(".next").removeClass("disabled").find("a").attr("href",a+(e.page+1)),r.filter(".last").removeClass("disabled").find("a").attr("href",a+Math.ceil(e.total/e.limit)))}}function auto_bjmfHelp(){$("[bjmf-help]").click(function(){var e=$(this);e.css("cursor","pointer");var t="alert";if(e.attr("help-type")&&(t=e.attr("help-type")),"iframe"==t)bjmf_iframe(e.attr("help-url"),e.attr("help-title"));else{var a=e.attr("help-content");a||(a=$(e.attr("bjmf-help")).html()),bjmf_alert(a,e.attr("help-title"))}})}function getLayer(e){"object"==typeof layer?e(layer):loadScript(("undefined"==typeof sitecdn?"//c.d8n.cn":window.sitecdn)+"/layer/layer.js",function(){e(layer)})}function bjmf_msg(e){getLayer(function(t){t.msg(e)})}function bjmf_tips(e,t){getLayer(function(a){a.tips(e,t)})}function bjmf_alert(e){getLayer(function(t){t.alert(e)})}function bjmf_confirm(e,t,a){getLayer(function(r){r.confirm(e,{},t,a)})}function bjmf_iframe(e,t,a){getLayer(function(r){r.open({type:2,title:t,area:[.9*$(window).width()+"px",.9*$(window).height()+"px"],content:e,end:function(){void 0!==a&&a()}})})}function bjmf_prompt(e,t,a){getLayer(function(r){r.prompt({value:a||"",title:e},function(e,a,n){t(e),r.close(a)})})}function bjmf_attachment_format(e,t){var a=[];if("string"==typeof e&&"["==e.substr(0,1)&&"]"==e.substr(e.length-1,1)&&e.indexOf('"file"')>-1&&e.indexOf('"name"')>-1)a=JSON.parse(e);else{if("object"!=typeof e||null===e)return e;a=e}var r="";return $.each(a,function(e,a){r+=void 0===t?'<a target="_blank" href="'+a.file+'">附件'+(e+1)+"</a> ":'<a href="javascript:void(0);" onclick="'+t+"('"+a.file+"')\">附件"+(e+1)+"</a> "}),r}function easyui_attachment_format(e,t,a){return bjmf_attachment_format(e,void 0)}function cutString(e,t){if(2*e.length<=t)return e;for(var a=0,r="",n=0;n<e.length;n++)if(r+=e.charAt(n),e.charCodeAt(n)>128){if((a+=2)>=t)return r.substring(0,r.length-1)+"..."}else if((a+=1)>=t)return r.substring(0,r.length-2)+"...";return r}function bjmf_cmdbar(e,t){$("<style>.bjmf-cmdbar{font-size:14px;color:#555}.bjmf-cmdbar-items{clear:both;margin:0;padding:0}.bjmf-cmdbar-item{padding:0 4px;margin:0;border:0;cursor:pointer;display:inline-block}.bjmf-cmdbar-item i{padding:0 4px;color:#0078d4;height:22px;line-height:22px}.bjmf-cmdbar-item span{padding:0}.bjmf-cmdbar-showarea{overflow:hidden}.bjmf-cmdbar-showarea li{float:left}.bjmf-cmdbar-morearea{position:relative;text-align:right;display:none}</style>").appendTo("body"),_bjmf_cmdbar_html='<div class="bjmf-cmdbar"><ul class="bjmf-cmdbar-items bjmf-cmdbar-showarea"></ul><ul class="bjmf-cmdbar-items bjmf-cmdbar-morearea"></ul></div>',$(e).html(_bjmf_cmdbar_html),$.each(t,function(e,t){_tmpstyle="",void 0!==t.style&&(_tmpstyle=t.style),_bjmfcmdbar_tmp_html='<li class="bjmf-cmdbar-item" style="'+_tmpstyle+'"><i class="'+t.icon+'"></i><span>'+t.title+"</span></li>",$(_bjmfcmdbar_tmp_html).bind("click",t.click).appendTo(".bjmf-cmdbar-showarea")}),_morebtnhtml='<li class="bjmf-cmdbar-item" onclick="$(\'.bjmf-cmdbar-morearea\').toggle();"><i class="las la-ellipsis-h"></i></li>',_morebtnlen=30,_maxlen=$(".bjmf-cmdbar").width()-_morebtnlen,_curlen=0,_willAddToMore=!1,_allea=$(".bjmf-cmdbar-showarea").find(".bjmf-cmdbar-item"),_allealen=_allea.length,_lastlen=_maxlen,_allea.each(function(e,t){return _willAddToMore?($(this).clone(!0).appendTo(".bjmf-cmdbar-morearea"),void $(this).remove()):(_thisitemlen=$(this).outerWidth(),_curlen+_thisitemlen>_maxlen?($(_morebtnhtml).appendTo(".bjmf-cmdbar-showarea"),_willAddToMore=!0,$(this).clone(!0).appendTo(".bjmf-cmdbar-morearea"),void $(this).remove()):(_curlen+=_thisitemlen,void(_lastlen=_maxlen-_curlen)))})}function href(e){document.location.href=e}function geoDistance(e,t,a,r){let n=rad(e),o=rad(a),i=n-o,d=rad(t)-rad(r),l=2*Math.asin(Math.sqrt(Math.pow(Math.sin(i/2),2)+Math.cos(n)*Math.cos(o)*Math.pow(Math.sin(d/2),2)));return l*=6378137,l=Math.round(l)}function rad(e){return e*Math.PI/180}function geoDistance2Ranges(e,t,a){if(0==a.length)return-1;for(var r=1e7,n=0;n<a.length;n++){var o=a[n],i=geoDistance(e,t,o[0],o[1])-o[2];if(r=Math.min(r,i),i<=50)return-1}return r}function bjmf_timestamp2str(e){for(var t=(e+"").split(""),a=0;a<13;a++)t[a]||(t[a]="0");e=1*t.join("");var r=(new Date).getTime()-e;if(r<0)return"不久前";var n,o=r/2592e6,i=r/6048e5,d=r/864e5,l=r/36e5,c=r/6e4,s=function(e){return e<10?"0"+e:e};return o>12?(n=new Date(e)).getFullYear()+"年"+s(n.getMonth()+1)+"月"+s(n.getDate())+"日":o>=1?parseInt(o)+"月前":i>=1?parseInt(i)+"周前":d>=1?parseInt(d)+"天前":l>=1?parseInt(l)+"小时前":c>=1?parseInt(c)+"分钟前":"刚刚"}function bjmf_form_filldata(_form_jq_object,___formdata){_form_jq_object.find("input,select,textarea").each(function(){if(_ele_e=$(this),_ele_e.is("[name]")){_ele_name=_ele_e.attr("name").trim(),_is_array=!1,"[]"==_ele_name.substr(_ele_name.length-2)?_v_k=_ele_name.substr(0,_ele_name.length-2):_v_k=_ele_name,_v_k="___formdata."+_v_k.replace(/]/g,"").replace(/\[/g,".");try{___v=eval(_v_k)}catch(e){return}"undefined"!=typeof ___v&&(_ele_e.is("input")&&"checkbox"==_ele_e.attr("type")?___v.indexOf(_ele_e.val())>-1&&_ele_e.prop("checked",!0):_ele_e.is("select")&&_ele_e.is("[multiple]")?_ele_e.find("option").each(function(){___v.indexOf($(this).attr("value"))>-1&&$(this).prop("selected",!0)}):_ele_e.is("input")&&"radio"==_ele_e.attr("type")?_ele_e.val()==___v&&_ele_e.prop("checked",!0):_ele_e.val(___v))}})}function urladd(e,t){for(_urlk in void 0!==t&&""!=t&&0!=t||(t=document.location.href),e)t=changeQueryString(_urlk,e[_urlk],t);return t}function urlallflow(e,t){void 0!==t&&""!=t&&0!=t||(t=document.location.href),$("a[href]").each(function(){var a=$(this),r=a.attr("href");if("#"!=r.sub(0,1)&&"javascript:"!=r.sub(0,11)&&"tel:"!=r.sub(0,4)){var n=urlflow(r,t,e);a.attr("href",n)}})}function urlflow(e,t,a){if(void 0!==t&&""!=t&&0!=t||(t=document.location.href),-1==t.indexOf("?"))return e;null==a&&(a=!1);var r=t.substr(t.indexOf("?")+1).split("&");for(_qs_i in r){var n=r[_qs_i];if(-1!=n.indexOf("=")){var o=n.split("=");!1!==a&&-1==a.indexOf(o[0])||(e=changeQueryString(o[0],o[1],e,!0))}}return e}function changeQueryString(e,t,a,r){if(null==t)return a;if(null==r&&(r=!1),-1==a.indexOf("?"))return a+"?"+e+"="+t;var n=!1,o=a.substr(a.indexOf("?")+1).split("&");for(_qs_i in o){var i=o[_qs_i];if(-1!=i.indexOf("="))i.split("=")[0]==e&&(n=!0,r||(!1===t?o.splice(_qs_i,1):o[_qs_i]=e+"="+t))}return n||o.push(e+"="+t),a.substr(0,a.indexOf("?"))+"?"+o.join("&")}$(function(){auto_bjmfHelp(),autoLinkTextNodes(),bjmf_rdochk_ini(),renderPagination(),$(".form-control-datetimepicker").on("click",function(){weuidatetimepicker(this)}),$(".form-control-timepicker").on("click",function(){weuitimepicker(this)}),$(".form-control-date-picker").on("click",function(){weuidatepicker(this)}),addRedDots(),$(".text2html").each(function(){var e=$(this);e.html(text2html(e.text()))})});var data_bjmf_course_getdata_data={};function bjmf_course_getdata(e,t,a){var r=parseInt((new Date).valueOf()/1e3),n="cd_"+e+"_"+t;if(void 0!==data_bjmf_course_getdata_data[n])return a(data_bjmf_course_getdata_data[n]);"undefined"==typeof urlRoot&&(urlRoot="/"+document.location.pathname.split("/")[1]);var o=urlRoot+"/data/course/"+(e||0)+"/"+t;if(window.localStorage){var i=!1,d=window.localStorage.getItem(n),l=window.localStorage.getItem(n+"_lask");if(d)try{i=JSON.parse(d)}catch(e){console.log("localStorageJSON error")}if(i&&i.v){var c=i.v,s=i.data;if(r-c<180)return console.log(n,"3分钟内新数据，不再问"),"undefined"!=typeof bjmf_filter_coursedata&&(s=bjmf_filter_coursedata(t,s)),data_bjmf_course_getdata_data[n]=s,a(s);if(r-l<180)return console.log(n,"3分钟内问询过，不再问"),"undefined"!=typeof bjmf_filter_coursedata&&(s=bjmf_filter_coursedata(t,s)),data_bjmf_course_getdata_data[n]=s,a(s);$.ajax({url:o+"?v="+c,ldatakey:n,vnow:r,ltruedata:s,success:function(e){window.localStorage.setItem(this.ldatakey+"_lask",this.vnow),void 0!==e.noc&&1==e.noc?("undefined"!=typeof bjmf_filter_coursedata&&(s=bjmf_filter_coursedata(t,this.ltruedata)),data_bjmf_course_getdata_data[this.ldatakey]=this.ltruedata,a(this.ltruedata)):(window.localStorage.setItem(this.ldatakey,JSON.stringify(e)),"undefined"!=typeof bjmf_filter_coursedata&&(s=bjmf_filter_coursedata(t,e.data)),data_bjmf_course_getdata_data[this.ldatakey]=s,a(s))},dataType:"json"})}else $.ajax({url:o+"?f=1&v="+r,ldatakey:n,success:function(e){var r=e.data;window.localStorage.setItem(this.ldatakey,JSON.stringify(e)),"undefined"!=typeof bjmf_filter_coursedata&&(r=bjmf_filter_coursedata(t,e.data)),data_bjmf_course_getdata_data[this.ldatakey]=r,a(r)},dataType:"json"})}}function hideLayUiMenuInIframe(){window.parent&&window.parent!==window&&($("#leftmenuarea").remove(),$("#LAY_app_body").css({left:0}),$(function(){var e=$("#headmenuarea");e.find("> .layui-layout-right").remove(),e.find("> .layui-layout-left").css({left:0}).find("> li:not(:first)").remove()}))}function navpod(e,t,a){bjmf_course_getdata(e,"navpod",function(r){for(_np_item_key in _np_html="",r)_item=r[_np_item_key],_np_html+=navpod_item2html(_item,e,t);$("#navpod").html(_np_html),"function"==typeof a&&a(r)})}function navpod_item2html(e,t,a){return void 0===e.id||void 0===e.name?"":(void 0!==e.url?"string"==typeof e.url?_url=e.url:_url=e.url[role]:_url=menucode2url(e.id,t,a),_url=_url.replace("{ROLE}",a).replace("{COURSEID}",t),_url=_url.replace("/ROLE/","/"+a+"/").replace("/COURSEID","/"+t),tpl2html($("#tpl_navpod_item").html(),{url:_url,item:e}))}function menucode2url(e,t,a){return _url="",_ca=e.split("@"),_modulecode=_ca[0],"profile"==_modulecode&&(_ca.length>1?_ca[1].indexOf(",")>-1?_url=_url="/{ROLE}/course/{COURSEID}/profiles?ids="+_ca[1]:_url="/{ROLE}/course/{COURSEID}/profile/"+_ca[1]:_url="/{ROLE}/course/{COURSEID}/profiles"),"activity"==_modulecode&&(_ca.length>1?_ca[1].indexOf(",")>-1?_url=_url="/{ROLE}/course/{COURSEID}/activitys?ids="+_ca[1]:_url="/{ROLE}/course/{COURSEID}/activitys/show?id="+_ca[1]:_url="/{ROLE}/course/{COURSEID}/activitys"),_url}function installOptionalBox(){$(".optional-box-ctrl").each(function(){var e=$(this),t=e.find(".la"),a=e.siblings(".optional-box");e.on("click",function(){t.hasClass("la-angle-double-down")?(t.removeClass("la-angle-double-down").addClass("la-angle-double-up"),a.removeClass("hide")):(t.removeClass("la-angle-double-up").addClass("la-angle-double-down"),a.addClass("hide"))})})}function openLocation(e){if(!e)return alert("地址为空！");if(!e.split)return alert("无效地址："+e);var t=e.split(",");if(!t||!t[0]||!t[1])return alert("无效地址："+e);if(!window.wx||!window.wx.openLocation)return openMap(e);try{wx.openLocation({latitude:Number(t[0]),longitude:Number(t[1]),scale:22,fail:function(t){t&&"openLocation:fail"===t.errMsg?openMap(e):alert("打开地图失败！"+(t?t.errMsg:null)||"未知错误")}.bind(this)})}catch(e){alert("打开地图失败："+e.message)}}function openMap(e){window.open("http://api.map.baidu.com/geocoder?location="+e+"&coord_type=gcj02&output=html&src=com.banjimofang")}function clearlocal(e){void 0===e?confirm("确认清理本地缓存?  系统可能会将一些班级学生列表保存到本地缓存，如果本地网络异常导致没有及时更新，可能会导致新加入学生不显示姓名等问题出现。可在此手动清理以加载最新数据。")&&(localStorage.clear(),alert("清理完成")):localStorage.clear()}function in_mobile(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}function in_weixin(){return navigator.userAgent.indexOf("MicroMessenger")>-1}function in_wxapp(){return navigator.userAgent.indexOf("miniProgram")>-1}function show_draw_pad(e){loadScript((void 0===window.sitecdn?"//c.d8n.cn":window.sitecdn)+"/js/common/draw_pad.js?v=2023091901",function(){new DrawPad(e).show()})}function render_draw_pad(e){loadScript((void 0===window.sitecdn?"//c.d8n.cn":window.sitecdn)+"/js/common/draw_pad.js?v=2023091901",function(){"function"==typeof e?e():DrawPad.renderResult(e)})}$(function(){installOptionalBox()});var loaded_app_js=!0;try{window.parent!==window&&window.parent.location.href.indexOf("/org")>=0&&($("html").addClass("embed-in-org"),$(function(){hideLayUiMenuInIframe()}))}catch(e){console.log(e)}function isMiniProgram(){return navigator.userAgent.indexOf("miniProgram")>=0}function logCourseUsage(){if(window.gconfig&&"teacher"===gconfig.role&&window.COURSE_ID){var e="loguse_course_"+window.COURSE_ID;if(window.localStorage){var t=parseInt((new Date).getTime()/1e3),a=window.localStorage.getItem(e);if(a&&t-parseInt(a)<=64800)return;window.localStorage.setItem(e,t)}$.ajax("/teacher/course/"+window.COURSE_ID+"?op=loguse")}}function logTeacherUsage(){if(window.gconfig&&"teacher"===gconfig.role){if(window.localStorage){var e=parseInt((new Date).getTime()/1e3),t=window.localStorage.getItem("loguse_teacher");if(t&&e-parseInt(t)<=64800)return;window.localStorage.setItem("loguse_teacher",e)}$.ajax("/teacher?op=loguse")}}$(function(){isMiniProgram()&&$('a[href*="8n.cn"]').each(function(){var e=$(this),t=e.attr("href");t.toLowerCase().startsWith("http://")&&(t="https://"+t.substring("http://".length),e.attr("href",t))}),logTeacherUsage(),logCourseUsage()});
